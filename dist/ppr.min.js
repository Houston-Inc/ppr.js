!function(){"use strict";"undefined"==typeof define&&"undefined"==typeof exports&&(window.ppr={page:{},component:{},library:{utils:{}},module:{model:{}},ui:{}})}();
!function(e,t){"function"==typeof define&&define.amd?define("ppr.config",["lodash"],t):"object"==typeof exports?module.exports=t(require("lodash")):e.ppr.config=t(e._)}(this,function(e){"use strict";var t={};return{get:function(n,o){return e.result(t,n,o)},getAll:function(){return t},set:function(n,o){var r=n;"string"==typeof n&&(r={},r[n]=o),e.each(r,function(n,o){e.set(t,o,n)})},reset:function(){t={}}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.library.event_bus_prototype",["jquery","lodash"],t):"object"==typeof exports?module.exports=t(require("jquery"),require("lodash")):e.ppr.library.event_bus_prototype=t(e.$,e._)}(this,function(e,t){"use strict";var i=function(t){this.eventList={},this.messageIndex={},this.configList=e.extend({},{debug:!1},t)};return i.prototype={getEvents:function(){return this.eventList},getEventsByMessage:function(e){return"undefined"!=typeof this.eventList[e]?this.eventList[e]:{}},log:function(e,t,i){if(this.configList.debug!==!0)return!1;Array.prototype.slice.call(arguments).splice(2,2);switch(e){case"subscribe":break;case"unsubscribe":break;case"publish":}},subscribe:function(e,i,n,s){"undefined"==typeof this.eventList[i]&&(this.eventList[i]={});var r=t.uniqueId(i);return this.log("subscribe",i,r,e),this.eventList[i][r]={scope:e,callback:n,name:s||r},this.messageIndex[r]=i,r},unsubscribe:function(e){"string"==typeof e&&(e=[e]);var i=this;return t.each(e,function(n){if("undefined"==typeof i.messageIndex[n])return!1;var s=i.messageIndex[n];return i.log("unsubscribe",s,e),"undefined"!=typeof i.eventList[s][n]&&(delete i.eventList[s][n],void(0===t.keys(i.eventList[s]).length&&delete i.eventList[s]))}),!0},publish:function(e,i){if("undefined"==typeof this.eventList[e])return!1;var n=Array.prototype.slice.call(arguments);return n.unshift(t.map(this.eventList[e],"name")),this.publishTo.apply(this,n)},publishTo:function(e,i,n){if("undefined"==typeof this.eventList[i])return!1;"string"==typeof e&&(e=[e]);var s,r=Array.prototype.slice.call(arguments).splice(2);s=t.filter(this.eventList[i],function(i){return t.indexOf(e,i.name)>-1}),this.log("publish",i,r,t.map(s,"scope")),t.each(s,function(e){e.callback.apply(e.scope,r)})}},i});
!function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.date",["ppr.translation"],e):"object"==typeof exports?module.exports=e(require("../../ppr.translation")):t.ppr.library.utils.date=e(t.ppr.translation)}(this,function(t){"use strict";return{getAsDate:function(t){if("object"==typeof t)return t;if("number"==typeof t)return new Date(t);var e;return(e=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2}) ([0-9]{2}):([0-9]{2}):([0-9]{2})$/,"g"))?new Date(e[1],e[2]-1,e[3],e[4],e[5],e[6]):(e=t.match(/^([0-9]{2}).([0-9]{1,2}).([0-9]{4}) ([0-9]{1,2}):([0-9]{2}):([0-9]{2})$/,"g"))?new Date(e[3],e[2]-1,e[1],e[4],e[5],e[6]):new Date(t)},getDifference:function(t,e){return"undefined"==typeof e&&(e=new Date),t=this.getAsDate(t),e=this.getAsDate(e),(e.getTime()-t.getTime())/1e3},getAsDifferenceString:function(e){return e<60?Math.floor(e)+t.translate("date.sec_ago"):e<3600?Math.floor(e/60)+t.translate("date.min_ago"):e<86400?Math.floor(e/60/60)+t.translate("date.hour_ago"):Math.floor(e/60/60/24)+t.translate("date.day_ago")},formatDate:function(t){var e=t.getFullYear().toString(),r=(t.getMonth()+1).toString(),n=t.getDate().toString(),a=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();return n+"."+r+"."+e+" klo "+a+":"+o}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.library.utils.loader",["lodash"],t):"object"==typeof exports?module.exports=t(require("lodash")):e.ppr.library.utils.loader=t(e._)}(this,function(e){"use strict";return{bulkModules:null,addBulkModules:function(t){this.bulkModules=e.merge(this.getBulkModules(),t)},hasAMDSupport:function(){return"function"==typeof define&&define.amd},hasCommonSupport:function(){return"object"==typeof exports},getBulkModules:function(){return null===this.bulkModules&&(this.bulkModules=this.loadBulkModules()),this.bulkModules},load:function(t,o,u){var n=this;if("function"!=typeof u)throw new Error("Callback has to present");"object"!=typeof t&&(t=[t]);var r=[];return this.hasAMDSupport()?(o.custom===!0&&(t=e.map(t,function(e){if(e.lastIndexOf(".")>e.lastIndexOf("/")){e=e.split(".");var t=e.pop();e=e.join(".")+"/"+t}return e})),require(t,u)):this.hasCommonSupport()?(e.each(t,function(t){t=t.split("."),t.shift(),t=e.map(t,e.camelCase),r.push(e.result(n.getBulkModules(),t.join(".").toLowerCase().trim()))}),u.apply(null,r)):(e.each(t,function(t){r.push(e.get(window,t))}),u.apply(null,r))},loadBulkModules:function(){var e={};if(!this.hasCommonSupport())return e;var t=require("bulk-require");return e=t(__dirname+"/../../",["**/*.js"])}}});
!function(t,r){"function"==typeof define&&define.amd?define("ppr.library.utils.object",[],r):"object"==typeof exports?module.exports=r():t.ppr.library.utils.object=r()}(this,function(){"use strict";return{stringify:function(t){var r;if("string"==typeof t)return t;try{r=JSON.stringify(t)}catch(e){r=""}return r},parseJSON:function(t){var r;if("object"==typeof t)return t;try{r=JSON.parse(t)}catch(e){r={}}return r}}});
!function(e,r){"function"==typeof define&&define.amd?define("ppr.library.utils.request",["lodash"],r):"object"==typeof exports?module.exports=r(require("lodash")):e.ppr.library.utils.request=r(e._)}(this,function(){"use strict";return{query:{},getQueryParam:function(e,r,t){var n=this.getQueryParams(t);return n.hasOwnProperty(e)?n[e]:"undefined"!=typeof r?r:null},getQueryParams:function(e){"undefined"==typeof e&&(e=window.location.href);var r,t,n={},i=e.indexOf("?");return this.query.hasOwnProperty(e)?this.query[e]:i===-1?n:(r=e.substring(i+1),t=r.split("&"),_.each(t,function(e){var r=e.split("=");n[r[0]]=r[1]}),this.query[e]=n,n)}}});
!function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.storage",["ppr.config"],e):"object"==typeof exports?module.exports=e(require("../../ppr.config")):t.ppr.library.utils.storage=e(t.ppr.config)}(this,function(t){"use strict";return{configList:$.extend({enabled:!0},t.get("storage",{})),isEnabled:function(){return this.configList.enabled===!0&&this.isSupported()},isSupported:function(){return"undefined"!=typeof window.localStorage},set:function(t,e){if(!this.isEnabled())return null;if("object"==typeof e)try{e=JSON.stringify(e)}catch(i){}window.localStorage.setItem(t,e)},get:function(t){if(!this.isEnabled())return null;var e=window.localStorage.getItem(t);try{e=JSON.parse(e)}catch(i){}return e}}});
!function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.string",["lodash"],e):"object"==typeof exports?module.exports=e(require("lodash")):t.ppr.library.utils.string=e(t._)}(this,function(t){"use strict";return{generateHash:function(t){var e,r,a,n=0;if(0===t.length)return n;for(e=0,a=t.length;e<a;e++)r=t.charCodeAt(e),n=(n<<5)-n+r,n|=0;return n},getAsPlainText:function(t){return $("<p>").html(t).text()},linkifyHashTags:function(t,e){var r,a;return a={twitter:"https://twitter.com/hashtag/",facebook:"https://www.facebook.com/hashtag/",instagram:"https://www.instagram.com/explore/tags/"},e=e.toLowerCase(),"undefined"==typeof a[e]?t:(r=a[e],t=t.replace(/[#]+[A-Za-z0-9-_äöåÄÖÅ]+/g,function(t){var e,a;return e=t.replace("#",""),a=$("<a>").attr("class","hashtag").attr("href",r+e).attr("target","_blank").text(t),a[0].outerHTML}))},replaceVariablesWithParameters:function(e,r){return t.each(r,function(t,r){e=e.replace(":"+r,t)}),e}}});
!function(i,t){"function"==typeof define&&define.amd?define("ppr.library.utils.window",["ppr.config","jquery","lodash"],t):"object"==typeof exports?module.exports=t(require("../../ppr.config"),require("jquery"),require("lodash")):i.ppr.library.utils.window=t(i.ppr.config,i.$,i._)}(this,function(i,t,n){"use strict";return{configList:t.extend(!0,{breakpoints:{},mobile_breakpoints:[]},i.get("window",{})),isBreakpoint:function(i){return"undefined"!=typeof this.configList.breakpoints[i]},isMobile:function(){var i=this,t=!1;return n.each(this.configList.mobile_breakpoints,function(n){t||(t=i.matchBreakpoint(n))}),t},matchBreakpoint:function(i){if(!this.isBreakpoint(i))return!1;if("function"!=typeof window.matchMedia)return!1;var t=this.configList.breakpoints[i],r=n.replace(t,/[<>]/,"").trim();return n.startsWith(t,"<")?window.matchMedia("(max-width: "+r+"px)").matches:!!n.startsWith(t,">")&&window.matchMedia("(min-width: "+r+"px)").matches},transformations:function(i){return{"-webkit-transform":i,"-moz-transform":i,"-ms-transform":i,"-o-transform":i,transform:i}},whichTransitionEvent:function(){var i,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(i in n)if(void 0!==t.style[i])return n[i]}}});
!function(t,i){"function"==typeof define&&define.amd?define("ppr.translation",["ppr.config","ppr.library.utils.string","lodash"],i):"object"==typeof exports?module.exports=i(require("./ppr.config"),require("./library/utils/string"),require("lodash")):t.ppr.translation=i(t.ppr.config,t.ppr.library.utils.string,t._)}(this,function(t,i,n){"use strict";var e;return e={isInitialized:!1,language:void 0,translationList:void 0,initialize:function(){this.language=t.get("language","en"),this.translationList=t.get("translations",{})},getAll:function(){return this.isInitialized||this.initialize(),this.translationList},getLanguage:function(t){return"undefined"!=typeof t?t:this.language},getPrefixedKey:function(t,i){return t+"."+i},translate:function(t,e,r){this.isInitialized||this.initialize();var a=n.result(this.translationList,this.getPrefixedKey(this.getLanguage(r),t),t);return"undefined"!=typeof e&&(a=i.replaceVariablesWithParameters(a,e)),a}},{getAll:function(){return e.getAll()},translate:function(t,i,n){return e.translate(t,i,n)}}});
!function(t,e){"function"==typeof define&&define.amd?define("ppr.component.base_prototype",["ppr.library.utils.object"],e):"object"==typeof exports?module.exports=e(require("../library/utils/object")):t.ppr.component.base_prototype=e(t.ppr.library.utils.object)}(this,function(t){"use strict";return{children:void 0,eventBus:null,data:{},href:null,id:null,name:null,node:null,page:null,parent:void 0,messages:{},isBuilt:!1,cacheData:{},cacheSubscribers:[],afterBuild:function(){this.eventBus.publish("component_build_finished",this.id),this.isBuilt=!0},build:function(){},getChildren:function(){var t=this;if("undefined"==typeof this.children){var e=[];_.each(this.node.find("[data-component]"),function(n){var i=$(n).attr("data-component-id"),a=t.page.getComponent(i);a.getParent().id===t.id&&e.push(i)}),this.children=e}var n=[];return _.each(this.children,function(e){n.push(t.page.getComponent(e))}),n},getParent:function(){if("undefined"!=typeof this.parent)return this.page.getComponent(this.parent);var t=this.node.parents("[data-component]:first"),e=null;return t.length&&(e=t.attr("data-component-id")),this.parent=e,this.page.getComponent(this.parent)},getRequiredModules:function(){return[]},initialize:function(e){this.id=e.id,this.node=e.node,this.name=e.name,this.eventBus=e.eventBus,this.page=e.page,this.cacheData=this.data,this.node.attr({"data-component":this.name,"data-component-id":this.id}),this.node.attr("data-component-href")&&(this.href=this.node.attr("data-component-href")),this.node.attr("data-component-data")&&(this.data=$.extend({},this.data,t.parseJSON(this.node.attr("data-component-data"))))},isBuildable:function(){return $.Deferred().resolve().promise()},reset:function(){this.data=$.extend(!0,{},this.cacheData),this.href=null,this.isBuilt=!1,this.eventBus.unsubscribe(this.cacheSubscribers)},setModuleMessages:function(t){this.messages=t}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.component.reloadable_prototype",["ppr.component.base_prototype","jquery"],t):"object"==typeof exports?module.exports=t(require("./baseprototype"),require("jquery")):e.ppr.component.reloadable_prototype=t(e.ppr.component.base_prototype,e.$)}(this,function(e,t){"use strict";return t.extend(!0,{},e,{componentLoaderWrapper:null,afterBuild:function(){this.componentLoaderWrapper=this.node.find(".component-loader__wrapper"),this.eventBus.subscribe(this,"reload",this.reload,this.id),this.eventBus.subscribe(this,"reload_started",this.onReloadStarted,this.id),this.eventBus.subscribe(this,"reload_ready",this.onReloadReady,this.id),this.eventBus.subscribe(this,"reload_components",this.reload),this.eventBus.publish("component_build_finished",this.id),this.isBuilt=!0},onReloadStarted:function(){this.componentLoaderWrapper.length&&this.componentLoaderWrapper.addClass("component-loader__wrapper--active")},onReloadReady:function(e){e=e.filter("*:not(text):not(comment)"),this.reset(),this.node.replaceWith(e),e.attr("data-component-id",this.id),this.eventBus.publish("build_component",e)},reload:function(){var e=this;this.eventBus.publishTo(this.id,"reload_started"),t.get(this.href).done(function(o){e.eventBus.publishTo(e.id,"reload_ready",t(o))})}})});
!function(i,e){"function"==typeof define&&define.amd?define("ppr.module.base_prototype",[],e):"object"==typeof exports?module.exports=e():i.ppr.module.base_prototype=e()}(this,function(){"use strict";return{isInitialized:!1,configList:{},eventBus:void 0,messages:{},build:function(){},initialize:function(i,e){return!this.isInitialized&&(this.eventBus=e,this.configList=$.extend({},this.configList,i),this.isInitialized=!0,this.build(),!0)},getMessages:function(){return this.messages}}});
!function(e,i){"function"==typeof define&&define.amd?define("ppr.ui.builder_prototype",["ppr.library.utils.loader","lodash"],i):"object"==typeof exports?module.exports=i(require("../library/utils/loader"),require("lodash")):e.ppr.ui.builder_prototype=i(e.ppr.library.utils.loader,e._)}(this,function(e,i){"use strict";return{initialize:function(){var i=this;return!!this.shouldBuild()&&void e.load(this.getDependencies(),{custom:!0},function(){i.build.apply(i,Array.prototype.slice.call(arguments))})},shouldBuild:function(){return!0},getDependencies:function(){return[]}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.page.base_prototype",["ppr.config","ppr.library.utils.object","ppr.library.utils.loader","ppr.library.event_bus_prototype","jquery","lodash"],t):"object"==typeof exports?module.exports=t(require("../ppr.config"),require("../library/utils/object"),require("../library/utils/loader"),require("../library/eventbusprototype"),require("jquery"),require("lodash")):e.ppr.page.base_prototype=t(e.ppr.config,e.ppr.library.utils.object,e.ppr.library.utils.loader,e.ppr.library.event_bus_prototype,e.$,e._)}(this,function(e,t,n,i,o,s){"use strict";return{eventBus:new i(e.get("event_bus",{})),name:null,node:null,components:{},data:null,cacheComponentReady:[],afterBuild:function(){this.setDefaultSubscribers(),this.buildComponents(this.node),this.buildUIExtensions()},build:function(){return!0},buildComponent:function(e){var t,i=this,r=e.attr("data-component").trim(),u=s.snakeCase(r),p={},a={};return r.length>0?(t="ppr.component."+u,a.custom=!0):e.attr("data-component-href")?(t="ppr.component.reloadable_prototype",r="reloadable_prototype"):(t="ppr.component.base_prototype",r="base_prototype"),e.attr("data-component-id")?p.id=e.attr("data-component-id"):p.id=s.uniqueId("Component_"),("undefined"==typeof this.components[p.id]||!this.components[p.id].isBuilt)&&(p.name=r,p.node=e,p.eventBus=this.eventBus,p.page=this,void n.load(t,a,function(t){var r=new function(){return o.extend(!0,{},t)};i.components[p.id]=r,r.initialize(p);var u=r.getRequiredModules(),a=s.map(u,function(e){return"ppr.module."+e});n.load(a,{custom:!0},function(){var t=Array.prototype.slice.call(arguments),n={};s.each(t,function(e,t){e.initialize({},i.eventBus),n[u[t]]=e.getMessages()}),r.setModuleMessages(n),r.isBuildable().then(function(t){return r.build(t)===!1?(delete i.components[p.id],void e.remove()):void r.afterBuild()})})}))},buildComponents:function(e){var t=this;e.find("[data-component]").each(function(e,n){t.eventBus.publish("build_component",o(n))})},buildUIExtensions:function(){n.load(e.get("ui.builders",[]),{custom:!0},function(){var e=Array.prototype.slice.call(arguments);s.each(e,function(e){e.initialize()})})},getComponent:function(e){return"undefined"!=typeof this.components[e]?this.components[e]:null},initialize:function(e){return this.name=e.name,this.node=e.node,this.data={},this.node.attr("data-page-data")&&(this.data=o.extend({},this.data,t.parseJSON(this.node.attr("data-page-data")))),!0},onComponentBuildFinished:function(e){this.cacheComponentReady.push(e),this.cacheComponentReady.length===s.keys(this.components).length&&this.eventBus.publish("page_build_finished")},removeComponent:function(e){"string"==typeof e&&(e=[e]);var t=this;s.each(e,function(e){var n=t.components[e];"undefined"!=typeof n&&(n.reset(),n.node.remove(),delete t.components[e])})},setDefaultSubscribers:function(){this.eventBus.subscribe(this,"remove_component",this.removeComponent),this.eventBus.subscribe(this,"build_components",this.buildComponents),this.eventBus.subscribe(this,"build_component",this.buildComponent),this.eventBus.subscribe(this,"build_extensions",this.buildUIExtensions),this.eventBus.subscribe(this,"component_build_finished",this.onComponentBuildFinished)}}});
!function(e,i){"function"==typeof define&&define.amd?define("ppr",["jquery","lodash","ppr.library.utils.loader","ppr.config"],i):"object"==typeof exports?module.exports=i(require("jquery"),require("lodash"),require("./library/utils/loader"),require("./ppr.config")):e.ppr=e._.assign(e.ppr,i(e.jQuery,e._,e.ppr.library.utils.loader,e.ppr.config))}(this,function(e,i,r,n){"use strict";return{build:function(){this.buildPage()},buildPage:function(){var n=this,t="ppr.page.base_prototype",o=e("body"),a=o.attr("data-page"),u={},p={};"undefined"!=typeof a&&a.length>0?(t="ppr.page."+i.snakeCase(a.trim()),p.custom=!0):a="base_prototype",u.name=a,u.node=o,r.load(t,p,function(i){var r=new function(){return e.extend(!0,{},i)};r.initialize(u),n.page_instance=r,r.build(),r.afterBuild()})},loadConfig:function(i){var r=this,n=e.Deferred();return e.ajax({dataType:"json",url:i,success:function(e){r.setConfig(e),n.resolve(e)},fail:function(){n.reject("Load configuration failed")}}),n.promise()},setConfig:function(e){i.each(e,function(e,i){n.set(i,e)})}}});