!function(){"use strict";"undefined"==typeof define&&"undefined"==typeof exports&&(window.ppr={page:{},component:{},library:{utils:{}},module:{model:{}},ui:{}},window.vendor={},window.vendor.$=window.$.noConflict(),window.vendor._=window._.noConflict())}();
!function(e,t){"function"==typeof define&&define.amd?define("ppr.config",["lodash"],t):"object"==typeof exports?module.exports=t(require("lodash")):e.ppr.config=t(e.vendor._)}(this,function(e){"use strict";var t={};return{get:function(n,o){return e.result(t,n,o)},getAll:function(){return t},set:function(n,o){var r=n;"string"==typeof n&&(r={},r[n]=o),e.each(r,function(n,o){e.set(t,o,n)})},reset:function(){t={}}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.library.event_bus_prototype",["ppr.config","jquery","lodash"],t):"object"==typeof exports?module.exports=t(require("../ppr.config"),require("jquery"),require("lodash")):e.ppr.library.event_bus_prototype=t(e.ppr.config,e.vendor.$,e.vendor._)}(this,function(e,t,n){"use strict";var i=function(){this.eventList={},this.messageIndex={}};return i.prototype={getEvents:function(){return this.eventList},getEventsByMessage:function(e){return"undefined"!=typeof this.eventList[e]?this.eventList[e]:{}},log:function(t,n,i){if(e.get("event_bus.debug",!1)!==!0)return!1;Array.prototype.slice.call(arguments).splice(2,2);switch(t){case"subscribe":break;case"unsubscribe":break;case"publish":}},subscribe:function(e,t,i,s){"undefined"==typeof this.eventList[t]&&(this.eventList[t]={});var r=n.uniqueId(t);return this.log("subscribe",t,r,e),this.eventList[t][r]={scope:e,callback:i,name:s||r},this.messageIndex[r]=t,r},unsubscribe:function(e){"string"==typeof e&&(e=[e]);var t=this;return n.each(e,function(i){if("undefined"==typeof t.messageIndex[i])return!1;var s=t.messageIndex[i];return t.log("unsubscribe",s,e),"undefined"!=typeof t.eventList[s][i]&&(delete t.eventList[s][i],void(0===n.keys(t.eventList[s]).length&&delete t.eventList[s]))}),!0},publish:function(e,t){if("undefined"==typeof this.eventList[e])return!1;var i=Array.prototype.slice.call(arguments);return i.unshift(n.map(this.eventList[e],"name")),this.publishTo.apply(this,i)},publishTo:function(e,t,i){if("undefined"==typeof this.eventList[t])return!1;"string"==typeof e&&(e=[e]);var s,r=Array.prototype.slice.call(arguments).splice(2);s=n.filter(this.eventList[t],function(t){return n.indexOf(e,t.name)>-1}),this.log("publish",t,r,n.map(s,"scope")),n.each(s,function(e){e.callback.apply(e.scope,r)})}},i});
!function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.date",["ppr.translation"],e):"object"==typeof exports?module.exports=e(require("../../ppr.translation")):t.ppr.library.utils.date=e(t.ppr.translation)}(this,function(t){"use strict";return{getAsDate:function(t){if("object"==typeof t)return t;if("number"==typeof t)return new Date(t);var e;return(e=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2}) ([0-9]{2}):([0-9]{2}):([0-9]{2})$/,"g"))?new Date(e[1],e[2]-1,e[3],e[4],e[5],e[6]):(e=t.match(/^([0-9]{2}).([0-9]{1,2}).([0-9]{4}) ([0-9]{1,2}):([0-9]{2}):([0-9]{2})$/,"g"))?new Date(e[3],e[2]-1,e[1],e[4],e[5],e[6]):new Date(t)},getDifference:function(t,e){return"undefined"==typeof e&&(e=new Date),t=this.getAsDate(t),e=this.getAsDate(e),(e.getTime()-t.getTime())/1e3},getAsDifferenceString:function(e){return e<60?Math.floor(e)+t.translate("date.sec_ago"):e<3600?Math.floor(e/60)+t.translate("date.min_ago"):e<86400?Math.floor(e/60/60)+t.translate("date.hour_ago"):Math.floor(e/60/60/24)+t.translate("date.day_ago")},formatDate:function(t){var e=t.getFullYear().toString(),r=(t.getMonth()+1).toString(),n=t.getDate().toString(),a=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();return n+"."+r+"."+e+" klo "+a+":"+o}}});
!function(t,i){"function"==typeof define&&define.amd?define("ppr.library.utils.loader",["ppr.config","lodash"],i):"object"==typeof exports?module.exports=i(require("../../ppr.config"),require("lodash")):t.ppr.library.utils.loader=i(t.ppr.config,t.vendor._)}(this,function(t,i){"use strict";return{bulkModules:null,isInitialized:!1,configList:{supportAMD:!0,supportCommon:!0},addBulkModules:function(t){this.bulkModules=i.merge(this.getBulkModules(),t)},hasAMDSupport:function(){return this.configList.supportAMD===!0&&"function"==typeof define&&define.amd},hasCommonSupport:function(){return this.configList.supportCommon===!0&&"object"==typeof exports},getBulkModules:function(){return null===this.bulkModules&&(this.bulkModules=this.loadBulkModules()),this.bulkModules},initialize:function(){this.configList=i.extend(this.configList,t.get("universal_loader",{})),this.isInitialized=!0},load:function(t,e,o){this.isInitialized||this.initialize();var n=this;if("function"!=typeof o)throw new Error("Callback has to present");"object"!=typeof t&&(t=[t]);var u=[];return this.hasAMDSupport()?(e.custom===!0&&(t=i.map(t,function(t){if(t.lastIndexOf(".")>t.lastIndexOf("/")){t=t.split(".");var i=t.pop();t=t.join(".")+"/"+i}return t})),require(t,o)):this.hasCommonSupport()?(i.each(t,function(t){t=t.split("."),t.shift(),t=i.map(t,i.camelCase),u.push(i.result(n.getBulkModules(),t.join(".").toLowerCase().trim()))}),o.apply(null,u)):(i.each(t,function(t){u.push(i.get(window,t))}),o.apply(null,u))},loadBulkModules:function(){var t={};if(!this.hasCommonSupport())return t;var i=require("bulk-require");return t=i(__dirname+"/../../",["**/*.js"])}}});
!function(r,t){"function"==typeof define&&define.amd?define("ppr.library.utils.object",[],t):"object"==typeof exports?module.exports=t():r.ppr.library.utils.object=t()}(this,function(){"use strict";return{stringify:function(r){var t;if("string"==typeof r)return r;try{t=JSON.stringify(r)}catch(n){t=""}return t},parseJSON:function(r){var t;if("object"==typeof r)return r;try{t=JSON.parse(r)}catch(n){t={}}return t},assign:function(r){if(void 0===r||null===r)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(r),n=1;n<arguments.length;n++){var e=arguments[n];if(void 0!==e&&null!==e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])}return t}}});
!function(e,r){"function"==typeof define&&define.amd?define("ppr.library.utils.request",["lodash"],r):"object"==typeof exports?module.exports=r(require("lodash")):e.ppr.library.utils.request=r(e.vendor._)}(this,function(){"use strict";return{query:{},getQueryParam:function(e,r,t){var n=this.getQueryParams(t);return n.hasOwnProperty(e)?n[e]:"undefined"!=typeof r?r:null},getQueryParams:function(e){"undefined"==typeof e&&(e=window.location.href);var r,t,n={},i=e.indexOf("?");return this.query.hasOwnProperty(e)?this.query[e]:i===-1?n:(r=e.substring(i+1),t=r.split("&"),_.each(t,function(e){var r=e.split("=");n[r[0]]=r[1]}),this.query[e]=n,n)}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.library.utils.storage",["ppr.config","jquery"],t):"object"==typeof exports?module.exports=t(require("../../ppr.config"),require("jquery")):e.ppr.library.utils.storage=t(e.ppr.config,e.vendor._)}(this,function(e,t){"use strict";return{configList:t.extend({enabled:!0},e.get("storage",{})),isEnabled:function(){return this.configList.enabled===!0&&this.isSupported()},isSupported:function(){return"undefined"!=typeof window.localStorage},set:function(e,t){if(!this.isEnabled())return null;if("object"==typeof t)try{t=JSON.stringify(t)}catch(r){}window.localStorage.setItem(e,t)},get:function(e){if(!this.isEnabled())return null;var t=window.localStorage.getItem(e);try{t=JSON.parse(t)}catch(r){}return t}}});
!function(t,e){"function"==typeof define&&define.amd?define("ppr.library.utils.string",["lodash","jquery"],e):"object"==typeof exports?module.exports=e(require("lodash"),require("jquery")):t.ppr.library.utils.string=e(t.vendor._,t.vendor.$)}(this,function(t,e){"use strict";return{generateHash:function(t){var e,r,a,n=0;if(0===t.length)return n;for(e=0,a=t.length;e<a;e++)r=t.charCodeAt(e),n=(n<<5)-n+r,n|=0;return n},getAsPlainText:function(t){return e("<p>").html(t).text()},linkifyHashTags:function(t,r){var a,n;return n={twitter:"https://twitter.com/hashtag/",facebook:"https://www.facebook.com/hashtag/",instagram:"https://www.instagram.com/explore/tags/"},r=r.toLowerCase(),"undefined"==typeof n[r]?t:(a=n[r],t=t.replace(/[#]+[A-Za-z0-9-_äöåÄÖÅ]+/g,function(t){var r,n;return r=t.replace("#",""),n=e("<a>").attr("class","hashtag").attr("href",a+r).attr("target","_blank").text(t),n[0].outerHTML}))},replaceVariablesWithParameters:function(e,r){return t.each(r,function(t,r){e=e.replace(":"+r,t)}),e}}});
!function(i,t){"function"==typeof define&&define.amd?define("ppr.library.utils.window",["ppr.config","jquery","lodash"],t):"object"==typeof exports?module.exports=t(require("../../ppr.config"),require("jquery"),require("lodash")):i.ppr.library.utils.window=t(i.ppr.config,i.vendor.$,i.vendor._)}(this,function(i,t,n){"use strict";return{configList:t.extend(!0,{breakpoints:{},mobile_breakpoints:[]},i.get("window",{})),isBreakpoint:function(i){return"undefined"!=typeof this.configList.breakpoints[i]},isMobile:function(){var i=this,t=!1;return n.each(this.configList.mobile_breakpoints,function(n){t||(t=i.matchBreakpoint(n))}),t},matchBreakpoint:function(i){if(!this.isBreakpoint(i))return!1;if("function"!=typeof window.matchMedia)return!1;var t=this.configList.breakpoints[i],r=n.replace(t,/[<>]/,"").trim();return n.startsWith(t,"<")?window.matchMedia("(max-width: "+r+"px)").matches:!!n.startsWith(t,">")&&window.matchMedia("(min-width: "+r+"px)").matches},transformations:function(i){return{"-webkit-transform":i,"-moz-transform":i,"-ms-transform":i,"-o-transform":i,transform:i}},whichTransitionEvent:function(){var i,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(i in n)if(void 0!==t.style[i])return n[i]}}});
!function(t,i){"function"==typeof define&&define.amd?define("ppr.translation",["ppr.config","ppr.library.utils.string","lodash"],i):"object"==typeof exports?module.exports=i(require("./ppr.config"),require("./library/utils/string"),require("lodash")):t.ppr.translation=i(t.ppr.config,t.ppr.library.utils.string,t.vendor._)}(this,function(t,i,n){"use strict";var e;return e={isInitialized:!1,language:void 0,translationList:void 0,initialize:function(){this.language=t.get("language","en"),this.translationList=t.get("translations",{})},getAll:function(){return this.isInitialized||this.initialize(),this.translationList},getLanguage:function(t){return"undefined"!=typeof t?t:this.language},getPrefixedKey:function(t,i){return t+"."+i},translate:function(t,e,r){this.isInitialized||this.initialize();var a=n.result(this.translationList,this.getPrefixedKey(this.getLanguage(r),t),t);return"undefined"!=typeof e&&(a=i.replaceVariablesWithParameters(a,e)),a}},{getAll:function(){return e.getAll()},translate:function(t,i,n){return e.translate(t,i,n)}}});
!function(t,e){"function"==typeof define&&define.amd?define("ppr.component.base_prototype",["ppr.library.utils.object","jquery"],e):"object"==typeof exports?module.exports=e(require("../library/utils/object"),require("jquery")):t.ppr.component.base_prototype=e(t.ppr.library.utils.object,t.vendor.$)}(this,function(t,e){"use strict";return{children:void 0,eventBus:null,data:{},href:null,id:null,name:null,node:null,page:null,parent:void 0,messages:{},isBuilt:!1,cacheData:{},cacheSubscribers:[],createComponent:function(e){return t.assign({},this,e)},afterBuild:function(){this.eventBus.publish("component_build_finished",this.id),this.isBuilt=!0},build:function(){},getChildren:function(){var t=this;if("undefined"==typeof this.children){var n=[];_.each(this.node.find("[data-component]"),function(i){var a=e(i).attr("data-component-id"),s=t.page.getComponent(a);s.getParent().id===t.id&&n.push(a)}),this.children=n}var i=[];return _.each(this.children,function(e){i.push(t.page.getComponent(e))}),i},getParent:function(){if("undefined"!=typeof this.parent)return this.page.getComponent(this.parent);var t=this.node.parents("[data-component]:first"),e=null;return t.length&&(e=t.attr("data-component-id")),this.parent=e,this.page.getComponent(this.parent)},getRequiredModules:function(){return[]},initialize:function(n){this.id=n.id,this.node=n.node,this.name=n.name,this.eventBus=n.eventBus,this.page=n.page,this.cacheData=this.data,this.node.attr({"data-component":this.name,"data-component-id":this.id}),this.node.attr("data-component-href")&&(this.href=this.node.attr("data-component-href")),this.node.attr("data-component-data")&&(this.data=e.extend({},this.data,t.parseJSON(this.node.attr("data-component-data"))))},isBuildable:function(){return e.Deferred().resolve().promise()},reset:function(){this.data=e.extend(!0,{},this.cacheData),this.href=null,this.isBuilt=!1,this.eventBus.unsubscribe(this.cacheSubscribers)},setModuleMessages:function(t){this.messages=t}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.component.reloadable_prototype",["ppr.component.base_prototype","jquery"],t):"object"==typeof exports?module.exports=t(require("./baseprototype"),require("jquery")):e.ppr.component.reloadable_prototype=t(e.ppr.component.base_prototype,e.vendor.$)}(this,function(e,t){"use strict";return e.createComponent({componentLoaderWrapper:null,afterBuild:function(){this.componentLoaderWrapper=this.node.find(".component-loader__wrapper");var e=[this.eventBus.subscribe(this,"reload",this.reload,this.id),this.eventBus.subscribe(this,"reload_started",this.onReloadStarted,this.id),this.eventBus.subscribe(this,"reload_ready",this.onReloadReady,this.id),this.eventBus.subscribe(this,"reload_components",this.reload)];this.cacheSubscribers=this.cacheSubscribers.concat(e),this.eventBus.publish("component_build_finished",this.id),this.isBuilt=!0},onReloadStarted:function(){this.componentLoaderWrapper.length&&this.componentLoaderWrapper.addClass("component-loader__wrapper--active")},onReloadReady:function(e){e=e.filter("*:not(text):not(comment)"),this.reset(),this.node.replaceWith(e),e.attr("data-component-id",this.id),this.eventBus.publish("build_component",e)},reload:function(){var e=this;this.eventBus.publishTo(this.id,"reload_started"),t.get(this.href).done(function(o){e.eventBus.publishTo(e.id,"reload_ready",t(o))})}})});
!function(e,i){"function"==typeof define&&define.amd?define("ppr.module.base_prototype",["jquery"],i):"object"==typeof exports?module.exports=i(require("jquery")):e.ppr.module.base_prototype=i(e.vendor.$)}(this,function(e){"use strict";return{isInitialized:!1,configList:{},eventBus:void 0,messages:{},build:function(){},initialize:function(i,t){return!this.isInitialized&&(this.eventBus=t,this.configList=e.extend({},this.configList,i),this.isInitialized=!0,this.build(),!0)},getMessages:function(){return this.messages}}});
!function(e,t){"function"==typeof define&&define.amd?define("ppr.page.base_prototype",["ppr.config","ppr.library.utils.object","ppr.library.utils.loader","ppr.library.event_bus_prototype","jquery","lodash"],t):"object"==typeof exports?module.exports=t(require("../ppr.config"),require("../library/utils/object"),require("../library/utils/loader"),require("../library/eventbusprototype"),require("jquery"),require("lodash")):e.ppr.page.base_prototype=t(e.ppr.config,e.ppr.library.utils.object,e.ppr.library.utils.loader,e.ppr.library.event_bus_prototype,e.vendor.$,e.vendor._)}(this,function(e,t,n,i,o,s){"use strict";return{eventBus:new i,name:null,node:null,components:{},data:null,cacheComponentReady:[],createPage:function(e){return t.assign({},this,e)},afterBuild:function(){this.setDefaultSubscribers(),this.buildComponents(this.node),this.buildUIExtensions()},build:function(){return!0},buildComponent:function(e){var t,i=this,o=e.attr("data-component").trim(),r=s.snakeCase(o),u={},p={};return o.length>0?(t="ppr.component."+r,p.custom=!0):e.attr("data-component-href")?(t="ppr.component.reloadable_prototype",o="reloadable_prototype"):(t="ppr.component.base_prototype",o="base_prototype"),e.attr("data-component-id")?u.id=e.attr("data-component-id"):u.id=s.uniqueId("Component_"),("undefined"==typeof this.components[u.id]||!this.components[u.id].isBuilt)&&(u.name=o,u.node=e,u.eventBus=this.eventBus,u.page=this,void n.load(t,p,function(t){if("undefined"==typeof t)return!1;var o=t.createComponent({});i.components[u.id]=o,o.initialize(u);var r=o.getRequiredModules(),p=s.map(r,function(e){return"ppr.module."+e});n.load(p,{custom:!0},function(){var t=Array.prototype.slice.call(arguments),n={};s.each(t,function(e,t){e.initialize({},i.eventBus),n[r[t]]=e.getMessages()}),o.setModuleMessages(n),o.isBuildable().then(function(t){return o.build(t)===!1?(delete i.components[u.id],void e.remove()):void o.afterBuild()})})}))},buildComponents:function(e){var t=this;e.find("[data-component]").each(function(e,n){t.eventBus.publish("build_component",o(n))})},buildUIExtensions:function(){n.load(e.get("ui.builders",[]),{custom:!0},function(){var e=Array.prototype.slice.call(arguments);s.each(e,function(e){e.initialize()})})},getComponent:function(e){return"undefined"!=typeof this.components[e]?this.components[e]:null},initialize:function(e){return this.name=e.name,this.node=e.node,this.data={},this.node.attr("data-page-data")&&(this.data=o.extend({},this.data,t.parseJSON(this.node.attr("data-page-data")))),!0},onComponentBuildFinished:function(e){this.cacheComponentReady.push(e),this.cacheComponentReady.length===s.keys(this.components).length&&this.eventBus.publish("page_build_finished")},removeComponent:function(e){"string"==typeof e&&(e=[e]);var t=this;s.each(e,function(e){var n=t.components[e];"undefined"!=typeof n&&(n.reset(),n.node.remove(),delete t.components[e])})},setDefaultSubscribers:function(){this.eventBus.subscribe(this,"remove_component",this.removeComponent),this.eventBus.subscribe(this,"build_components",this.buildComponents),this.eventBus.subscribe(this,"build_component",this.buildComponent),this.eventBus.subscribe(this,"build_extensions",this.buildUIExtensions),this.eventBus.subscribe(this,"component_build_finished",this.onComponentBuildFinished)}}});
!function(e,i){"function"==typeof define&&define.amd?define("ppr.ui.builder_prototype",["ppr.library.utils.loader","lodash"],i):"object"==typeof exports?module.exports=i(require("../library/utils/loader"),require("lodash")):e.ppr.ui.builder_prototype=i(e.ppr.library.utils.loader,e.vendor._)}(this,function(e,i){"use strict";return{initialize:function(){var i=this;return!!this.shouldBuild()&&void e.load(this.getDependencies(),{custom:!0},function(){i.build.apply(i,Array.prototype.slice.call(arguments))})},shouldBuild:function(){return!0},getDependencies:function(){return[]}}});
!function(e,r){"function"==typeof define&&define.amd?define("ppr",["jquery","lodash","ppr.library.utils.loader","ppr.config"],r):"object"==typeof exports?module.exports=r(require("jquery"),require("lodash"),require("./library/utils/loader"),require("./ppr.config")):e.ppr=e.vendor._.assign(e.ppr,r(e.vendor.$,e.vendor._,e.ppr.library.utils.loader,e.ppr.config))}(this,function(e,r,i,n){"use strict";return{build:function(){this.buildPage()},buildPage:function(){var n=this,t="ppr.page.base_prototype",o=e("body"),a=o.attr("data-page"),p={},u={};"undefined"!=typeof a&&a.length>0?(t="ppr.page."+r.snakeCase(a.trim()),u.custom=!0):a="base_prototype",p.name=a,p.node=o,i.load(t,u,function(e){var r=e.createPage({});r.initialize(p),n.page_instance=r,r.build(),r.afterBuild()})},loadConfig:function(r){var i=this,n=e.Deferred();return e.ajax({dataType:"json",url:r,success:function(e){i.setConfig(e),n.resolve(e)},fail:function(){n.reject("Load configuration failed")}}),n.promise()},setConfig:function(e){r.each(e,function(e,r){n.set(r,e)})}}});